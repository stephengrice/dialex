<h1>Lesson: <%= @lesson.name %></h1>

<p>Translate the following:</p>

<% @exercises.each do |e| %>
  <form class="exercise-form" id="exercise<%= e.id %>">
    <div>
      <%= e.original %>
    </div>
    
    <div class="form-group">
      <input name="translation" type="text" class="form-control" />
    </div>
    <input name="id" type="hidden" value="<%= e.id %>" />
      
    <div>
      <button class="btn btn-primary" type="submit">Check</button>
    </div>
  </form>
<% end %>


<script>
$('form.exercise-form').submit(function(e) {
  e.preventDefault();
  var formData = $(this).serializeArray();
  var translation = formData[0].value;
  var id = formData[1].value;
  $.ajax({url: "/exercises/grade/" + id, method: 'GET', data: {translation: translation}}).done(function(result) {
    console.log(result);
    var field = $("#exercise" + id + " input[type=text]").first().parent();
    field.removeClass("has-success");
    field.removeClass("has-error");
    if (result.correct) {
      field.addClass("has-success");
    } else {
      field.addClass("has-error");
    }
  });
});
</script>